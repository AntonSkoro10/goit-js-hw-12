{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const markupItem = images => {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        comments,\n        views,\n        downloads,\n      }) => {\n        return `\n          <li class=\"gallery-item\">\n            <a href=\"${largeImageURL}\" class=\"gallery-link\">\n              <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-img\">\n            </a>\n            <div class=\"small-content\">\n              <small class=\"text-likes\">Likes: ${likes}</small>\n              <small class=\"text-views\">Views: ${views}</small>\n              <small class=\"text-comments\">Comments: ${comments}</small>\n              <small class=\"text-downloads\">Downloads: ${downloads}</small>\n            </div>\n          </li>`;\n      }\n    )\n    .join('');\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n})\n\nexport function renderImages(images) {\n  const gallery = document.querySelector('.gallery-list');\n  gallery.insertAdjacentHTML('beforeend', markupItem(images));\n}\n\nexport function clearGallery() {\n  const gallery = document.querySelector('.gallery-list');\n  gallery.innerHTML = '';\n}\n\nexport function showLoadMoreButton() {\n  const loadMoreBtn = document.querySelector('.btn-loader-js');\n  loadMoreBtn.classList.remove('is-hidden');\n}\n\nexport function hideLoadMoreButton() {\n  const loadMoreBtn = document.querySelector('.btn-loader-js');\n  loadMoreBtn.classList.add('is-hidden');\n}\n\nexport function showEndOfResultsMessage() {\n  const gallery = document.querySelector('.gallery-list');\n  const message = `<p class=\"end-of-results\">We're sorry, but you've reached the end of search results.</p>`;\n  gallery.insertAdjacentHTML('beforeend', message);\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nconst API_KEY = '43933435-35fbbd09623d667ed19d4c9fb'; \nconst BASE_URL = 'https://pixabay.com/api/';\n\nimport axios from 'axios'\n\naxios.defaults.baseURL = BASE_URL;\n\nexport async function fetchPhotos(query, page = 1, perPage = 20) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: perPage,\n  };\n\n  try {\n    const response = await axios.get('', { params });\n    return response.data;\n  } catch (error) {\n    throw new Error(error.response.statusText || 'Error fetching data');\n  }\n}\n\n\n","import {\n    renderImages,\n    clearGallery,\n    showLoadMoreButton,\n    hideLoadMoreButton,\n    showEndOfResultsMessage\n} from './js/render-functions.js';\n\nimport { fetchPhotos } from './js/pixabay-api.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet currentPage = 1;\nlet currentQuery = '';\n\nconst form = document.querySelector('.search-form');\nconst galleryElement = document.querySelector('.gallery-list');\nconst loader = document.querySelector('.js-loader');\nconst loadMoreBtn = document.querySelector('.btn-loader-js');\n\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    form.addEventListener('submit', onSearch);\n    loadMoreBtn.addEventListener('click', onLoadMore);\n});\n\n\nasync function onSearch(event) {\n  event.preventDefault();\n\n  currentQuery = event.target.elements.keyboardSearch.value.trim();\n  currentPage = 1;\n\n  if (currentQuery === '') {\n    clearGallery();\n    event.target.reset();\n    iziToast.error({\n      title: 'Error',\n      message: 'Search query cannot be empty!',\n      position: 'topRight',\n      timeout: 2000,\n    });\n    return;\n  }\n\n  clearGallery();\n  hideLoadMoreButton();\n  loader.classList.remove('is-hidden');\n\n  try {\n    const { hits, totalHits } = await fetchPhotos(currentQuery, currentPage);\n    if (hits.length === 0) {\n      iziToast.show({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        timeout: 2000,\n        color: 'red'\n      });\n      loader.classList.add('is-hidden');\n      return;\n    }\n    renderImages(hits);\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n\n    if (hits.length < totalHits) {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong, please try again later!',\n      position: 'topRight',\n      timeout: 2000,\n    });\n  } finally {\n    event.target.reset();\n    loader.classList.add('is-hidden');\n  }\n}\n\nasync function onLoadMore() {\n  currentPage += 1;\n\n  try {\n    const { hits, totalHits } = await fetchPhotos(currentQuery, currentPage);\n    renderImages(hits);\n\n    const totalLoadedImages = document.querySelectorAll('.gallery-list .gallery-item').length;\n    if (totalLoadedImages >= totalHits) {\n      hideLoadMoreButton();\n      showEndOfResultsMessage();\n    } else {\n      showLoadMoreButton();\n    }\n\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n\n    scrollPage();\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong, please try again later!',\n      position: 'topRight',\n      timeout: 2000,\n    });\n  }\n}\n\nfunction scrollPage() {\n  const { height: cardHeight } = document.querySelector('.gallery-list').firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["markupItem","images","webformatURL","largeImageURL","tags","likes","comments","views","downloads","SimpleLightbox","renderImages","clearGallery","gallery","showLoadMoreButton","hideLoadMoreButton","showEndOfResultsMessage","message","API_KEY","BASE_URL","axios","fetchPhotos","query","page","perPage","params","error","currentPage","currentQuery","form","loader","loadMoreBtn","onSearch","onLoadMore","event","iziToast","hits","totalHits","lightbox","scrollPage","cardHeight"],"mappings":"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"}